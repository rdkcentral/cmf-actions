name: "CLA Signature Check"

# Prevent concurrent runs for the same PR
concurrency:
  group: cla-${{ github.event.pull_request.number || github.event.issue.number }}
  cancel-in-progress: true

permissions:
  contents: read
  pull-requests: write
  actions: write
  statuses: write

on:
  issue_comment:
    types: [created]
  pull_request_target:
    types: [opened, closed, synchronize]

jobs:
  cla-signature-check:
    name: "Check CLA Signature"
    timeout-minutes: 10
    # Only run on comments that contain CLA-related keywords or on PR events
    if: |
      github.event_name == 'pull_request_target' ||
      (github.event_name == 'issue_comment' &&
       (contains(github.event.comment.body, 'recheck') ||
        contains(github.event.comment.body, 'I have read the CLA')))
    uses: rdkcentral/cmf-actions/.github/workflows/cla.yml@1.0.0
    secrets:
      PERSONAL_ACCESS_TOKEN: ${{ secrets.CLA_ASSISTANT }}
